```{r}
#Install required libraries
#install.packages("tensorflow")
#install.packages("caret")
#install.packages("keras")

#Import the Libraries
library(tensorflow)
library(caret)
library(magrittr)
library(keras)

# Load data
training <- read.csv("train.csv")
testing <- read.csv("test.csv")
```

```{r}
# Preprocess data
x_train <- as.matrix(training[, -ncol(training)])
y_train <- as.matrix(training[, ncol(training)])
x_test <- as.matrix(testing[, -ncol(testing)])
y_test <- as.matrix(testing[, ncol(testing)])

# Add target column to testing data
y_test <- data.frame(y_test)
names(y_test) <- "target"
testing_with_target <- cbind(testing, y_test)

# Define model
model <- keras_model_sequential() %>%
  layer_dense(units = 64, activation = "relu", input_shape = c(ncol(x_train))) %>%
  layer_dropout(rate = 0.2) %>%
  layer_dense(units = 32, activation = "relu") %>%
  layer_dropout(rate = 0.2) %>%
  layer_dense(units = 1, activation = "sigmoid")

# Compile model
model %>% compile(
  optimizer = optimizer_adam(learning_rate = 0.001),
  loss = "binary_crossentropy",
  metrics = c("accuracy")
)

# Train model
history <- model %>% fit(
  x = x_train,
  y = y_train,
  validation_split = 0.2,
  epochs = 50,
  batch_size = 32
)

# Evaluate model on test set
scores <- model %>% evaluate(
  x = as.matrix(testing_with_target[, -ncol(testing_with_target)]),
  y = testing_with_target[, ncol(testing_with_target)],
  verbose = 0
)

# Print test set accuracy
cat("Test accuracy:", scores[[2]], "\n")

```

